{% extends "base.html" %}

{% block sidebar %}
    {{ block.super }}  <!-- ê¸°ì¡´ base.htmlì˜ sidebar ë‚´ìš© ìœ ì§€ -->

    <h3>{{ project.title }}</h3>
    <p>{{ project.description }}</p>
    <p>ìƒì„± ë‚ ì§œ: {{ project.created_at }}</p>
    <p>ë§ˆì§€ë§‰ ìˆ˜ì •: {{ project.updated_at }}</p>

    <a href="{% url 'project-list' %}" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
    <!-- 
    <a href="{% url 'project-update' project.id %}" class="btn btn-warning">ìˆ˜ì •</a>
    <a href="{% url 'project-delete' project.id %}" class="btn btn-danger">ì‚­ì œ</a>
     -->
{% endblock %}

{% block content %}
    <!-- ë©”ì¸ ì½˜í…ì¸ : ê¸°ë³¸ì ìœ¼ë¡œ ë²„ì¸„ì–´íˆ¬ì–´ ì•± ë¡œë“œ -->
    <div id="main-content">
        <iframe id="app-frame" src="{% url 'virtual_tour:virtual_tour' project.id %}" frameborder="0" allow="fullscreen"></iframe>
    </div>
    
    <div class="bottom-icons">
        <button onclick="loadApp('virtual_tour')">ğŸ  </button>
        <button onclick="loadApp('3d_model')">ğŸ— </button>
        <button onclick="loadApp('image_list')">ğŸ–¼ </button>
    </div>


    <script>
        // iframeì— ìë™ìœ¼ë¡œ í¬ì»¤ìŠ¤ ì£¼ê¸°
        window.onload = function() {
            var iframe = document.getElementById('app-frame');
            
            // iframe ë¡œë“œ ì™„ë£Œ í›„ í¬ì»¤ìŠ¤ ì£¼ê¸°
            iframe.onload = function() {
                iframe.focus();
                console.log("iframeì— í¬ì»¤ìŠ¤ë¥¼ ì£¼ì—ˆìŠµë‹ˆë‹¤.");
            };
            
            // í˜ì´ì§€ í´ë¦­ ì‹œ iframeì— í¬ì»¤ìŠ¤ ì£¼ê¸°
            document.addEventListener('click', function() {
                iframe.focus();
            });
            
            // ì´ˆê¸° í¬ì»¤ìŠ¤ ì„¤ì •
            setTimeout(function() {
                iframe.focus();
                console.log("ì´ˆê¸° í¬ì»¤ìŠ¤ë¥¼ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.");
            }, 1000);
        };
        
        function loadApp(appType) {
            let url;
            if (appType === "virtual_tour") {
                url = "{% url 'virtual_tour:virtual_tour' project.id%}";
                console.log("project_detail.html > virtual_tour")
            } else if (appType === "3d_model") {
                url = "{% url 'virtual_tour:virtual_tour' project.id%}";
                console.log("project_detail.html > 3d_model")
            } else if (appType === "image_list") {
                url = "{% url 'virtual_tour:virtual_tour' project.id%}";
                console.log("project_detail.html > image_list")
            }
            document.getElementById("app-frame").src = url;
            
            // ì•± ë³€ê²½ í›„ iframeì— í¬ì»¤ìŠ¤ ì£¼ê¸°
            setTimeout(function() {
                document.getElementById("app-frame").focus();
            }, 1000);
        }
    </script>
{% endblock %}
